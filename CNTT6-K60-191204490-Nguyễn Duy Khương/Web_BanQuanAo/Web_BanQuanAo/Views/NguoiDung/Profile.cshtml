@model Web_BanQuanAo.Models.tblKhachHang

@{
    ViewBag.Title = "Profile";
    Layout = "~/Views/Shared/_LayoutSP.cshtml";
}
<head>
    <style>
        /*     body {
            background: #BA68C8
        }*/
        

        .form-control:focus {
            box-shadow: none;
            border-color: #BA68C8
        }

        .input-email {
            display: block;
            width: 100%;
            padding: 0.375rem 0.75rem;
            font-size: 1rem;
            font-weight: 400;
            line-height: 1.5;
            color: #212529;
            background-color: #fff;
            background-clip: padding-box;
            border: 1px solid #ced4da;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            border-radius: 0.25rem;
            transition: border-color .15s ease-in-out,box-shadow .15s ease-in-out;
            text-decoration: none;
        }

        .profile-button {
            background: #BA68C8;
            box-shadow: none;
            border: none
        }

            .profile-button:hover {
                background: #682773
            }

            .profile-button:focus {
                background: #682773;
                box-shadow: none
            }

            .profile-button:active {
                background: #682773;
                box-shadow: none
            }

        .back:hover {
            color: #682773;
            cursor: pointer
        }

        .labels {
            font-size: 11px
        }

        .add-experience:hover {
            background: #BA68C8;
            color: #fff;
            cursor: pointer;
            border: solid 1px #BA68C8
        }
    </style>
    @*<script>
            $(document).ready(function () {

                var a = $('#txtMaKH').val();

                GetAllCustomers(a)
                $('#txtMaKH').hide();
                $('#txtMatKhauCheck').hide();
            });
        </script>*@
    <script>
        $(document).ready(function () {

            var a = $('#txtMaKH').val();

            GetAllCustomers(a)
            $('#txtMaKH').hide();
            $('#txtMatKhauCheck').hide();
        });

        function GetAllCustomers(a) {

           /* var url = 'https://localhost:44364/api/khachhangapi/';*/
           /* if (a != "")*/ url = 'https://localhost:44364/api/khachhangapi/?maId=' + a
            $.ajax({
                url: url,
                method: 'GET',
                contentType: 'json',
                dataType: 'json',
                error: function (response) {
                },
                success: function (reponse) {

                    var len = reponse.length;
                    let table = '';
                    for (var i = 0; i < len; ++i) {
                        table = table + '<tr>';
                        table = table + '<td>' + reponse[i].MaKH + '</td>';
                        table = table + '<td>' + reponse[i].TenKH + '</td>';
                        table = table + '<td>' + reponse[i].MaHD + '</td>';
                        table = table + '<td>' + reponse[i].MaSP + '</td>';
                        table = table + '<td>' + reponse[i].TenSP + '</td>';
                        table = table + '<td>' + reponse[i].SoLuong + '</td>';
                        //table = table + '<td>' + reponse[i].Email + '</td>';
                        //table = table + '<td>' + '<button type="button" class="btn btn-danger update-button" onclick="deleteKH(' + reponse[i].MaKH + ');">' + "Xóa" + '</button>' + '</td>';
                        table = table + '</tr>';
                    }
                    $('#allKH').html(table);

                },
                fail: function (response) {
                }
            });
        }
        function updateKH() {

            if ($('#txtMatKhauCheck').val() != $('#txtMK').val() || $('#txtMatKhauCheck').val() == null) {
                alert('Mat khau nhap sai');
            }

            else {
                var url = 'https://localhost:44364/api/khachhangapi/?id=' + $('#txtMaKH').val()
                    + '&tenNguoiDung=' + $('#txtTaiKhoan').val()
                    + '&matKhau=' + $('#txtMkMoi').val()
                    + '&tenKH=' + $('#txtTenKH').val()
                    + '&diaChi=' + $('#txtDiaChi').val()
                    + '&dienThoai=' + $('#txtDienThoai').val()
                    + '&email=' + $('#txtEmail').val();


                $.ajax({
                    url: url,
                    method: 'PUT',
                    contentType: 'json',
                    dataType: 'json'
                }).done(function (res) {
                    if (!res) {
                        alert("Cập nhật không thành công!");
                    }
                    else {
                        /*ClearInput();*/
                        alert("Cập nhật  Thanh Cong");
                        GetAllCustomers();
                    }
                })
            }
        }


    </script>

</head>
<body>

    <div class="container rounded bg-white mt-5 mb-5">
        <div class="row" style="background: #f6f0f1">
            <div class="col-md-3 border-right">
                <div class="d-flex flex-column align-items-center text-center p-3 py-5"><img class="rounded-circle mt-5" src="https://i.imgur.com/V72SYyX.jpeg" width="90"><span class="font-weight-bold">@Html.DisplayFor(model => model.TenNguoiDung)</span><span class="text-black-50">@Html.DisplayFor(model => model.Email)</span><span>United States</span></div>
                <div class="col-md-6"><input type="text" class="form-control" value="@Html.DisplayFor(model => model.MaKH)" disabled id="txtMaKH"></div>
                <div class="col-md-6"><input type="text" class="form-control" value="@Html.DisplayFor(model => model.MatKhau)" disabled id="txtMatKhauCheck"></div>
            </div>
            <div class="col-md-5 border-right">
                <div class="p-3 py-5">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h6 class="text-right">Thông Tin Tài Khoản</h6>
                    </div>
                    <div class="row mt-3">
                        <div class="col-md-6"><label class="labels">Tên Tài Khoản</label><input type="text" class="form-control" placeholder="first name" value="@Html.DisplayFor(model => model.TenNguoiDung)" disabled id="txtTaiKhoan"></div>
                        <div class="col-md-6"><label class="labels">Mật Khẩu</label><input type="password" class="form-control" placeholder="Mật khẩu" id="txtMK"></div>
                        <div class="col-md-6"><label class="labels">Nhập Mật Khẩu mới</label><input type="text" class="form-control" id="txtMkMoi" placeholder="Mật khẩu mới"></div>
                    </div>
                    <div class="row mt-3">
                        <div class="col-md-12"><label class="labels">Họ Và Tên</label><input type="text" class="form-control" placeholder="headline" value="@Html.DisplayFor(model => model.TenKH)" id="txtTenKH"></div>
                        <div class="col-md-12"><label class="labels">Số Điện Thoại</label><input type="text" class="form-control" placeholder="headline" value="@Html.DisplayFor(model => model.DienThoai)" id="txtDienThoai"></div>
                        <div class="col-md-12"><label for="emails" class="labels">Email</label><span class="input-email" id="txtEmail">@Html.DisplayFor(model => model.Email) </span></div>
                    </div>
                    <div class="row mt-3">
                        <div class="col-md-6"><label class="labels">Địa Chỉ</label><input type="text" class="form-control" placeholder="country" value="@Html.DisplayFor(model => model.DiaChi)" id="txtDiaChi"></div>

                    </div>
                    <div class="mt-5 text-center"><button class="btn btn-primary profile-button" type="button" onclick="updateKH();">Save Profile</button></div>
                </div>
            </div>
            <div class="row">

                <div class="col-lg-12" style="overflow:scroll; height:500px">
                    <div class="table-responsive">
                        <table class="table table-striped table-bordered table-hover">
                            <thead>
                                <tr id="tableCTHD">
                                    <th>Mã Khách hàng</th>
                                    <th>Tên Khách Hàng</th>
                                    <th> Mã hóa đơn</th>
                                    <th> Mãc sản phẩm</th>
                                    <th>Tên sản phẩm</th>
                                    <th>số lượng</th>

                                </tr>

                            </thead>

                            <tbody id="allKH">
                            </tbody>
                        </table>
                    </div>


                </div>
            </div>
            <div class="col-md-4">
                <div class="p-3 py-5">
                    <div class="d-flex justify-content-between align-items-center experience"><span>Edit Experience</span><span class="border px-3 p-1 add-experience"><i class="fa fa-plus"></i>&nbsp;Experience</span></div>
                    <div class="d-flex flex-row mt-3 exp-container">
                        <img src="https://i.imgur.com/azSfBM3.png" width="45" height="45">
                        <div class="work-experience ml-1"><span class="font-weight-bold d-block">Senior UI/UX Designer</span><span class="d-block text-black-50 labels">Twitter Inc.</span><span class="d-block text-black-50 labels">March,2017 - May 2020</span></div>
                    </div>
                    <hr>
                    <div class="d-flex flex-row mt-3 exp-container">
                        <img src="https://img.icons8.com/color/100/000000/facebook.png" width="45" height="45">
                        <div class="work-experience ml-1"><span class="font-weight-bold d-block">Senior UI/UX Designer</span><span class="d-block text-black-50 labels">Facebook Inc.</span><span class="d-block text-black-50 labels">March,2017 - May 2020</span></div>
                    </div>
                    <hr>
                    <div class="d-flex flex-row mt-3 exp-container">
                        <img src="https://img.icons8.com/color/50/000000/google-logo.png" width="45" height="45">
                        <div class="work-experience ml-1"><span class="font-weight-bold d-block">UI/UX Designer</span><span class="d-block text-black-50 labels">Google Inc.</span><span class="d-block text-black-50 labels">March,2017 - May 2020</span></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>

