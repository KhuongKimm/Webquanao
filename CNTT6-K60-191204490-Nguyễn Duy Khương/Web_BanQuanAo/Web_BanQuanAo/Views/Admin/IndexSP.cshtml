
@{
    ViewBag.Title = "IndexSP";
    Layout = "~/Views/Shared/Admin.cshtml";
}

<style>
    img {
        width: 100px;
    }

    #test {
        /*border: 3px solid #00ff00;*/
        width: 100%;
        height: 500px;
        overflow-x: hidden;
        overflow-y: auto;
    }
</style>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script>


    function GetAllCustomers(a) {
        url = 'https://localhost:44364/api/customers/?TenSP=' + a
        $.ajax({
            url: url,
            method: 'GET',
            contentType: 'json',
            dataType: 'json',
            error: function (response) {
            },
            success: function (reponse) {

                var len = reponse.length;
                let table = '';
                for (var i = 0; i < len; ++i) {
                    table = table + '<tr>';
                    table = table + '<td>' + reponse[i].MaSP + '</td>';
                    table = table + '<td>' + reponse[i].TenSP + '</td>';
                    table = table + '<td>' + reponse[i].MaChatLieu + '</td>';
                    table = table + '<td>' + reponse[i].MauSac + '</td>';
                    table = table + '<td>' + reponse[i].HangSX + '</td>';
                    table = table + '<td>' + reponse[i].Gia + '</td>';
                    table = table + '<td>' + reponse[i].MaDT + '</td>';
                    table = table + '<td><img src ="/Images/LayoutData/' + reponse[i].Anh + '" /></td>';
                    table = table + '<td>' + reponse[i].Maloai + '</td>';
                    table = table + '<td>' + reponse[i].SoLuong + '</td>';
                    table = table + '<td>' + '<button type="button" class="btn btn-danger update-button" onclick="deleteSanPham('+ reponse[i].MaSP+');">' + "Xóa" + '</button>' + '</td>';
                    table = table + '</tr>';
                }
                $('#allSP').html(table);

            },
            fail: function (response) {
            }
        });
    }
    function deleteSanPham(a) {
        alert('ok');
        var url = 'https://localhost:44364/api/customers/?id=' +
            a
        $.ajax({
            url: url,
            method: 'DELETE',
            contentType: 'json',
            dataType: 'json',
            success: function (reponse) {
                console.log(reponse)
                if (reponse == false) {
                    alert("Xoá không thành công!");

                }
                else {
                    console.log(url);
                    alert("Xoá thành công!");

                    GetAllCustomers(''); //Gọi đến hàm lấy dữ liệu lên bảng
                }
            }
        });
    }
    function GetCustomerByMa(a) {

       var url = 'https://localhost:44364/api/customers/?MaSP=' + a
        $.ajax({
            url: url,
            method: 'GET',
            contentType: 'json',
            dataType: 'json',
            error: function (response) {
            },
            success: function (reponse) {

                var len = reponse.length;
                let table = '';
                for (var i = 0; i < len; ++i) {
                    table = table + '<tr>';
                    table = table + '<td>' + reponse[i].MaSP + '</td>';
                    table = table + '<td>' + reponse[i].TenSP + '</td>';
                    table = table + '<td>' + reponse[i].MaChatLieu + '</td>';
                    table = table + '<td>' + reponse[i].MauSac + '</td>';
                    table = table + '<td>' + reponse[i].HangSX + '</td>';
                    table = table + '<td>' + reponse[i].Gia + '</td>';
                    table = table + '<td>' + reponse[i].MaDT + '</td>';
                    table = table + '<td><img src ="/Images/LayoutData/' + reponse[i].Anh + '" /></td>';
                    table = table + '<td>' + reponse[i].Maloai + '</td>';
                    table = table + '<td>' + reponse[i].SoLuong + '</td>';

                    table = table + '</tr>';
                }
                $('#allSP').html(table);

            },
            fail: function (response) {
            }
        });
    }
    function chooseFile(fileInput) {
        if (fileInput.files && fileInput.files[0]) {
            var reader = new FileReader();
            reader.onload = function (e) {
                $('#image').attr('src', e.target.result);
            }
            reader.readAsDataURL(fileInput.files[0]);
        }
    }

</script>



<div class="container-fluid">
    <div>
        <div class="input-group custom-search-form" style="margin-top:10px;">
            <input type="text" class="form-control" placeholder="Tìm kiếm tên sản phẩm" id="txtFindMK">
            <span class="input-group-btn">
                <button class="btn btn-default" type="button">
                    <i class="fa fa-search"></i>
                </button>
            </span>
        </div>



        <div class="text-right" style="margin: 10px 0 10px 0">
            <button type="button" class="btn btn-danger update-button" style="color: white;">
                <a href="/Admin/ThemSanPham" style="color: white;">Thêm </a>
            </button>

            <button type="button" class="btn btn-danger update-button" id="ChinhSua" onclick=" GetSPSua(text1);">
                <a href="/Admin/Sua_Xoa_SP" style="color: white;">Sửa</a>

            </button>
        </div>
        <div class="dropdown">
            <button class="btn btn-default dropdown-toggle" type="button" id="dropdownSanPham" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                Sản Phẩm
                <span class="caret"></span>
            </button>
            <ul class="dropdown-menu" aria-labelledby="dropdownMenu1" id="txtSanPham">
                <li><a href="#" onclick="GetAllCustomers('');">Tat ca</a></li>
                <li><a href="#" onclick=" GetCustomerByMa('NGiay');">Giay Nam</a></li>
                <li><a href="#" onclick=" GetCustomerByMa('UGiay');">Giay Nu</a></li>
                <li><a href="#" onclick=" GetCustomerByMa('NQA');">Do nam</a></li>
                <li><a href="#" onclick=" GetCustomerByMa('UQA');">Do Nu</a></li>

            </ul>
        </div>
    </div>


    <div class="row">

        <div class="col-lg-12">
            <div class="table-responsive" id="test">
                <table class="table table-striped table-bordered table-hover">
                    <thead>
                        <tr>
                            <th>Ma Sản Phẩm</th>
                            <th>Tên Sản Phẩm</th>
                            <th>Mã Chất Liệu </th>
                            <th>Mã Mầu Sắc</th>
                            <th>Hãng Sản Xuất </th>
                            <th>Đơn Giá</th>
                            <th>Mã đối tượng</th>
                            <th>Ảnh</th>
                            <th>Mã Loại</th>
                            <th>Số Lượng  </th>
                        </tr>
                    </thead>

                    <tbody id="allSP">
                    </tbody>
                </table>
            </div>


        </div>
    </div>

</div>



